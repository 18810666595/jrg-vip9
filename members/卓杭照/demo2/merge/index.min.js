var $imgCt=$(".img-ct");var $imgLi=$imgCt.children();var $bullet=$(".bullet");var $firstImg=$imgCt.find("li").first();var $lastImg=$imgCt.find("li").last();var $imgWidth=$firstImg.width();var curPageIndex=0;var imgLength=$imgCt.children().length;var isAnimate=false;$imgCt.append($firstImg.clone());$imgCt.prepend($lastImg.clone());var imgRealLength=$imgCt.width($firstImg.width()*$imgCt.children().length);$imgCt.find("li").css({width:$imgWidth});$imgLi.find("img").css({width:$imgWidth});$imgCt.css({left:0-$imgWidth,width:imgRealLength});$("#header .pre").on("click",function(){playPre()});$("#header .next").on("click",function(){playNext()});$bullet.find("li").on("click",function(){var idx=$(this).index();if(idx>curPageIndex){playNext(idx-curPageIndex)}else{playPre(curPageIndex-idx)}});setBg(1);autoPlay();function setBg(num){var num=num||0;var $li=$imgCt.children().eq(num);var $cover=$li.find(".cover");var imgUrl=$cover.attr("data-bg-img");if($li.data("isBgSet")){return}$cover.css("background-image","url("+imgUrl+")");$li.data("isBgSet",true)}function playNext(num){var num=num||1;if(isAnimate){return}isAnimate=true;setBg(curPageIndex+2);$imgCt.animate({left:"-="+$imgWidth*num},function(){curPageIndex=(curPageIndex+num)%imgLength;if(curPageIndex===0){$imgCt.css({left:0-$imgWidth});curPageIndex=0}isAnimate=false;setBullet()})}function playPre(num){if(isAnimate){return}isAnimate=true;var num=num||1;setBg(curPageIndex);$imgCt.animate({"left":"+="+$imgWidth*num},function(){curPageIndex=(curPageIndex-num+imgLength)%imgLength;if(curPageIndex===imgLength-1){$imgCt.css({left:0-(imgLength*$imgWidth*num)})}isAnimate=false;setBullet()})}function setBullet(){$bullet.children().removeClass("active").eq(curPageIndex).addClass("active")}function autoPlay(){clock=setInterval(function(){playNext()},4000)}function stopAuto(){clearInterval(clock)}$("#header .title-service").on("click",function(e){$("body").animate({scrollTop:688});e.preventDefault()});$("#header .title-scenery").on("click",function(e){$("body").animate({scrollTop:1350});e.preventDefault()});$("#header .title-travel").on("click",function(e){$("body").animate({scrollTop:2477});e.preventDefault()});$("#header .title-team").on("click",function(e){$("body").animate({scrollTop:4049});e.preventDefault()});$("#header .title-contact").on("click",function(e){$("body").animate({scrollTop:5049});e.preventDefault()});GoTop($("body"));function GoTop($ct){this.$ct=$ct;this.target=$('<div class="go-top">回到顶部</div>');this.createNode();this.bindEvent()}function createNode(){this.$ct.append(this.target)}function bindEvent(){$(window).on("scroll",function(){if($(window).scrollTop()>100){$(".go-top").css("display","block")}else{$(".go-top").css("display","none")}});this.target.on("click",function(){$("body").animate({scrollTop:0})})};